{"version":3,"sources":["../src/unified_grader.js"],"names":["templateNames","grader","app","getHelpers","config","graderLayout","graderContainer","contentRegion","displayContent","html","js","Templates","replaceNode","showUser","userid","getContentForUserId","then","catch","Notification","exception","registerEventListeners","addEventListener","e","target","matches","Selectors","buttons","toggleFullscreen","stopImmediatePropagation","preventDefault","closeGrader","close","displayGrader","fullscreen","getContainer","render","replaceNodeContents","hideLoadingIcon","querySelector","regions","moduleReplace","launch","initialUserId"],"mappings":"0OAuBA,OACA,OACA,O,sDAGMA,CAAAA,CAAa,CAAG,CAClBC,MAAM,CAAE,CACJC,GAAG,CAAE,yBADD,CADU,C,CAMhBC,CAAU,CAAG,SAACC,CAAD,CAAY,IACvBC,CAAAA,CAAY,CAAG,IADQ,CAEvBC,CAAe,CAAG,IAFK,CAGvBC,CAAa,CAAG,IAHO,CAKrBC,CAAc,CAAG,SAACC,CAAD,CAAOC,CAAP,CAAc,CACjC,MAAOC,WAAUC,WAAV,CAAsBL,CAAtB,CAAqCE,CAArC,CAA2CC,CAA3C,CACV,CAP0B,CASrBG,CAAQ,CAAG,SAACC,CAAD,CAAY,CACzBV,CAAM,CACDW,mBADL,CACyBD,CADzB,EAEKE,IAFL,CAEUR,CAFV,EAGKS,KAHL,CAGWC,UAAaC,SAHxB,CAIH,CAd0B,CAiBrBC,CAAsB,CAAG,UAAM,CACjCd,CAAe,CAACe,gBAAhB,CAAiC,OAAjC,CAA0C,SAACC,CAAD,CAAO,CAC7C,GAAIA,CAAC,CAACC,MAAF,CAASC,OAAT,CAAiBC,UAAUC,OAAV,CAAkBC,gBAAnC,CAAJ,CAA0D,CACtDL,CAAC,CAACM,wBAAF,GACAN,CAAC,CAACO,cAAF,GAEAxB,CAAY,CAACsB,gBAAb,EACH,CALD,IAKO,IAAIL,CAAC,CAACC,MAAF,CAASC,OAAT,CAAiBC,UAAUC,OAAV,CAAkBI,WAAnC,CAAJ,CAAqD,CACxDR,CAAC,CAACM,wBAAF,GACAN,CAAC,CAACO,cAAF,GAEAxB,CAAY,CAAC0B,KAAb,EACH,CACJ,CAZD,CAaH,CA/B0B,CAiCrBC,CAAa,CAAG,UAAM,CACxB3B,CAAY,CAAG,mBAAuB,CAAC4B,UAAU,GAAX,CAAvB,CAAf,CACA3B,CAAe,CAAGD,CAAY,CAAC6B,YAAb,EAAlB,CAEA,MAAOvB,WAAUwB,MAAV,CAAiBnC,CAAa,CAACC,MAAd,CAAqBC,GAAtC,CAA2C,EAA3C,EACNc,IADM,CACD,SAACP,CAAD,CAAOC,CAAP,CAAc,CAChBC,UAAUyB,mBAAV,CAA8B9B,CAA9B,CAA+CG,CAA/C,CAAqDC,CAArD,EAEA,MAAOJ,CAAAA,CACV,CALM,EAMNU,IANM,CAMD,UAAM,CACRX,CAAY,CAACgC,eAAb,EAGH,CAVM,EAWNrB,IAXM,CAWD,UAAM,CACRT,CAAa,CAAGD,CAAe,CAACgC,aAAhB,CAA8Bb,UAAUc,OAAV,CAAkBC,aAAhD,CAGnB,CAfM,EAgBNxB,IAhBM,CAgBD,UAAM,CACRI,CAAsB,EAGzB,CApBM,EAqBNH,KArBM,EAsBV,CA3D0B,CA6D3B,MAAO,CACHJ,QAAQ,CAARA,CADG,CAEHmB,aAAa,CAAbA,CAFG,CAIV,C,UAEqB,QAATS,CAAAA,MAAS,CAACrC,CAAD,CAAY,OAI1BD,CAAU,CAACC,CAAD,CAJgB,CAE1BS,CAF0B,GAE1BA,QAF0B,CAG1BmB,CAH0B,GAG1BA,aAH0B,CAM9BA,CAAa,GAAGhB,IAAhB,CAAqB,UAAM,CACvB,GAAIZ,CAAM,CAACsC,aAAX,CAA0B,CACtB7B,CAAQ,CAACT,CAAM,CAACsC,aAAR,CACX,CAGJ,CAND,EAOCzB,KAPD,EAWH,C","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * This module will tie together all of the different calls the gradable module will make.\n *\n * @module     core_grades/unified_grader\n * @package    core_grades\n * @copyright  2019 Mathew May <mathew.solutions>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\nimport Templates from 'core/templates';\nimport Notification from 'core/notification';\nimport Selectors from './selectors';\nimport {createLayout as createFullScreenWindow} from 'mod_forum/local/layout/fullscreen';\n\nconst templateNames = {\n    grader: {\n        app: 'core_grades/grading_app',\n    },\n};\n\nconst getHelpers = (config) => {\n    let graderLayout = null;\n    let graderContainer = null;\n    let contentRegion = null;\n\n    const displayContent = (html, js) => {\n        return Templates.replaceNode(contentRegion, html, js);\n    };\n\n    const showUser = (userid) => {\n        config\n            .getContentForUserId(userid)\n            .then(displayContent)\n            .catch(Notification.exception);\n    };\n\n\n    const registerEventListeners = () => {\n        graderContainer.addEventListener('click', (e) => {\n            if (e.target.matches(Selectors.buttons.toggleFullscreen)) {\n                e.stopImmediatePropagation();\n                e.preventDefault();\n\n                graderLayout.toggleFullscreen();\n            } else if (e.target.matches(Selectors.buttons.closeGrader)) {\n                e.stopImmediatePropagation();\n                e.preventDefault();\n\n                graderLayout.close();\n            }\n        });\n    };\n\n    const displayGrader = () => {\n        graderLayout = createFullScreenWindow({fullscreen: false});\n        graderContainer = graderLayout.getContainer();\n\n        return Templates.render(templateNames.grader.app, {})\n        .then((html, js) => {\n            Templates.replaceNodeContents(graderContainer, html, js);\n\n            return graderContainer;\n        })\n        .then(() => {\n            graderLayout.hideLoadingIcon();\n\n            return;\n        })\n        .then(() => {\n            contentRegion = graderContainer.querySelector(Selectors.regions.moduleReplace);\n\n            return;\n        })\n        .then(() => {\n            registerEventListeners();\n\n            return;\n        })\n        .catch();\n    };\n\n    return {\n        showUser,\n        displayGrader,\n    };\n};\n\nexport const launch = (config) => {\n    const {\n        showUser,\n        displayGrader,\n    } = getHelpers(config);\n\n    displayGrader().then(() => {\n        if (config.initialUserId) {\n            showUser(config.initialUserId);\n        }\n\n        return;\n    })\n    .catch();\n\n    // You might instantiate the user selector here, and pass it the function displayContentForUser as the thing to call\n    // when it has selected a user.\n};\n"],"file":"unified_grader.min.js"}