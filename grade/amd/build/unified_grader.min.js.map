{"version":3,"sources":["../src/unified_grader.js"],"names":["getHelpers","config","displayContent","html","js","widget","document","createElement","className","dataset","replace","innerHTML","Templates","replaceNode","Selectors","regions","moduleReplace","displayUsers","gradingReplace","renderUserContent","index","user","getContentForUserId","id","then","renderUserPicker","state","userNames","map","firstname","lastname","userid","picker","UserPaginator","createPicker","showUser","catch","Notification","exception","getUsers","cmid","getUsersForCmidFunction","registerEventListeners","init","initialUserId","users"],"mappings":"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","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * This module will tie together all of the different calls the gradable module will make.\n *\n * @module     core_grades/unified_grader\n * @package    core_grades\n * @copyright  2019 Mathew May <mathew.solutions>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\nimport Templates from 'core/templates';\nimport Selectors from './selectors';\nimport * as UserPaginator from './unified_grader_user_paginator';\n\nconst getHelpers = (config) => {\n    const displayContent = (html, js) => {\n        let widget = document.createElement('div');\n        widget.className = \"grader-module-content-display col-sm-12\";\n        widget.dataset.replace = \"grader-module-content\";\n        widget.innerHTML = html;\n        return Templates.replaceNode(Selectors.regions.moduleReplace, widget, js);\n    };\n\n    const displayUsers = (html) => {\n        return Templates.replaceNode(Selectors.regions.gradingReplace, html);\n    };\n\n    const getUsers = (cmid) => {\n        return config\n            .getUsersForCmidFunction(cmid)\n            .catch(Notification.exception);\n    };\n    const showUser = (userid) => {\n        config\n            .getContentForUserId(userid)\n            .then(displayContent)\n            .catch(Notification.exception);\n    };\n\n    const renderUserContent = (index, user) => {\n        config.getContentForUserId(user.id)\n            .then((html, js) => {\n                let widget = document.createElement('div');\n                widget.className = \"grader-module-content-display col-sm-12\";\n                widget.dataset.replace = \"grader-module-content\";\n                widget.innerHTML = html;\n                return Templates.replaceNode(Selectors.regions.moduleReplace, widget, js);\n            });\n    };\n\n    const renderUserPicker = (state) => {\n        const userNames = state.map(user => ({firstname: user.firstname, lastname: user.lastname, userid: user.id}));\n        const picker = UserPaginator.createPicker(userNames, 0, renderUserContent);\n        return picker;\n\n    };\n    const registerEventListeners = () => {\n        // We have no event listeners to register yet.\n    };\n\n    return {\n        showUser,\n        getUsers,\n        renderUserPicker,\n        displayUsers,\n        registerEventListeners,\n    };\n};\n\nexport const init = (config) => {\n    const {\n        showUser,\n        getUsers,\n        renderUserPicker,\n        displayUsers,\n        registerEventListeners,\n    } = getHelpers(config);\n\n    if (config.initialUserId) {\n        showUser(config.initialUserId);\n    }\n\n    getUsers(config.cmid)\n        .then(state => {\n            renderUserPicker(state.users)\n                .then((picker) => {\n                    displayUsers(picker);\n            });\n        })\n        .catch();\n\n    registerEventListeners();\n\n    // You might instantiate the user selector here, and pass it the function displayContentForUser as the thing to call\n    // when it has selected a user.\n};\n"],"file":"unified_grader.min.js"}